class MetasploitDataModels::AutomaticExploitation::Match < ActiveRecord::Base
  attr_accessible :match_set_id, :module_fullname


  #
  # Associations
  #

  # @!attribute matchable
  #   A (polymorphic) "matchable" entity like a {Mdm::Vuln} or {Mdm::Service}
  #
  #   @return [Mdm::Vuln, Mdm::Service]
  belongs_to :matchable, polymorphic: true
  attr_accessible :matchable

  # @!attribute module_detail
  #   The MSF module that this match connects to
  #
  #   @return [Mdm::Module::Detail]
  belongs_to :module_detail,
             class_name: 'Mdm::Module::Detail',
             foreign_key: :module_fullname,
             primary_key: :fullname

  # @!attribute match_set
  #   The {MatchSet} this match is part of
  #
  #   @return [MetasploitDataModels::AutomaticExploitation::MatchResult]
  has_many :match_results,
             class_name: 'MetasploitDataModels::AutomaticExploitation::MatchResult',
             inverse_of: :match

  # @!attribute match_set
  #   The {MatchSet} this match is part of
  #
  #   @return [MetasploitDataModels::AutomaticExploitation::MatchSet]
  belongs_to :match_set,
             class_name: 'MetasploitDataModels::AutomaticExploitation::MatchSet',
             inverse_of: :matches

  Metasploit::Concern.run(self)
end
