require 'spec_helper'

describe MetasploitDataModels::AutomaticExploitation::Run do
  subject(:run){ FactoryGirl.create(:automatic_exploitation_run) }


  describe "database" do
    describe "columns" do
      it { is_expected.to have_db_column(:workspace_id).of_type(:integer)}
      it { is_expected.to have_db_column(:user_id).of_type(:integer)}
    end
  end

  describe "associations" do
    it {is_expected.to belong_to(:match_set).class_name('MetasploitDataModels::AutomaticExploitation::MatchSet') }
    it {is_expected.to belong_to(:workspace).class_name('Mdm::Workspace') }
    it {is_expected.to belong_to(:workspace).inverse_of(:automatic_exploitation_runs) }
    it {is_expected.to belong_to(:user).class_name('Mdm::User') }
    it {is_expected.to belong_to(:user).inverse_of(:automatic_exploitation_runs)}
    it {is_expected.to have_many(:match_results)}
  end
end