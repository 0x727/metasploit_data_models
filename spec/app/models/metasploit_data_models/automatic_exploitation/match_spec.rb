require 'spec_helper'

describe MetasploitDataModels::AutomaticExploitation::Match do
  it_should_behave_like 'Metasploit::Concern.run'


  describe "associations" do
    describe "connecting to a Mdm::Module::Detail" do
      let(:vuln){ FactoryGirl.create(:mdm_vuln) }
      let(:module_detail){FactoryGirl.create(:mdm_module_detail)}

      before(:each ) do
        subject.matchable = vuln
        subject.module_fullname = module_detail.fullname
        subject.save!
      end

      it 'should point to the Mdm::Module::Detail with a fullname corresponding to #module_fullname' do
        expect(subject.module_detail).to eq(module_detail)
      end

    end
  end
end
