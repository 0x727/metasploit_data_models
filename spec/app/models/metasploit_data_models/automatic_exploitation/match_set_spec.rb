require 'spec_helper'

describe MetasploitDataModels::AutomaticExploitation::MatchSet do
  describe "database" do
    describe "foreign_keys" do
      it { should have_db_column(:workspace_id).of_type(:integer) }
      it { should have_db_column(:user_id).of_type(:integer) }
    end

    describe "indices" do
      it { should have_db_index(:user_id) }
      it { should have_db_index(:workspace_id) }
    end
  end

  describe "associations" do
    it { should have_many(:matches).class_name('MetasploitDataModels::AutomaticExploitation::Match') }
    it { should have_many(:matches).inverse_of(:match_set) }
    it { should have_many(:runs).class_name('MetasploitDataModels::AutomaticExploitation::Run') }
    it { should have_many(:runs).inverse_of(:match_set) }
    it { should belong_to(:user).class_name('Mdm::User') }
    it { should belong_to(:user).inverse_of(:automatic_exploitation_match_sets) }
    it { should belong_to(:workspace).class_name('Mdm::Workspace') }
    it { should belong_to(:workspace).inverse_of(:automatic_exploitation_match_sets) }
  end

end